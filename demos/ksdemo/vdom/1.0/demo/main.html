<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Vdom的demo</title>
    <script src="http://g.tbcdn.cn/kissy/m/0.2.1/mini-full-min.js" charset="utf-8"></script>
</head>
<body>
<h2>Vdom的demo</h2>
<div class="container J_Container"></div>


<script type="text/juicer" id="J_Template">
<div class="hook">
    <h2 class="title-{@if even}even{@else}odd{@/if}">${title}</h2>
    <div class="list">
        {@each list as item, idx}
        <p key="${idx}">${item.name} 有 ${item.number} 个淘金币</p>
        {@/each}
    </div>
</div>
</script>

<a href="http://m.kissyui.com/" target="_blank">KISSY MINI官方文档</a>
<span id="QRCode"></span>
<script>
    (function(S) {
        var debug = ~location.search.indexOf('ks-debug');

        if (debug) {
            var srcPath = "../../";
            S.config({
                debug: debug,
                packages:[
                    {
                        name:"gallery/vdom",
                        path:srcPath,
                        charset:"utf-8",
                        ignorePackageNameInUri:true
                    }
                ]
            });
        }

        S.use('gallery/vdom/1.0/main', function (S, Vdom) {

            var template = S.one('#J_Template').html();

            var genData = function () {

                var i = 0,
                    names = ['Jack', 'Henry', 'Potter', 'Max', 'Lucy', 'Tom'],
                    list = [],
                    listCount = parseInt(Math.random() * 100 + 7, 10);

                while(i < listCount) {
                    list[i++] = {
                        name: names[i % 5],
                        number: parseInt(Math.random() * 10 + 11, 10)
                    };
                }

                return {
                    title: '这里有 ' + listCount + ' 个小朋友',
                    even: Boolean(listCount % 2),
                    count: listCount,
                    list: list
                };

            };
            var data = genData();

            var vDom = new Vdom({
                container: '.J_Container',
                template: template,
                data: data
            });

            setInterval(function(){

                var data = genData();
                vDom.set('data', data);

            }, 5000);

        })
    })(KISSY);
</script>
<script type="text/javascript">
    KISSY.use('gallery/qrcode/1.0/',function(S,QRCode){
        var qrcode = new QRCode("QRCode", {
            width: 128,
            height: 128,
            colorDark : "#000000",
            colorLight : "#ffffff",
            correctLevel : QRCode.CorrectLevel.H
        });

        qrcode.makeCode(location.href);
    });
</script>
</body>
</html>
