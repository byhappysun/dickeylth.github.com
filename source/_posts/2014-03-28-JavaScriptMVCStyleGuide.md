title: '[译]JavaScript MVC 风格指南'
date: 2014-03-28 14:46:24
tags: ['JavaScript', 'MVC']
category: '翻译'
---

JavaScript MVC的框架越来越多，但是如何写出真正满足 MVC 约定规则的代码呢？这篇来自 [Alex MacCaw](https://twitter.com/maccaw) 的分享介绍了他关于 JavaScript MVC 架构的代码的一些规则，值得学习一下。

<!--more-->

原文链接：[《JavaScript MVC Style Guide》](http://blog.sourcing.io/mvc-style-guide)


过去几年里我总结出一些 MVC web 应用的规则，很管用而且避免了庞大的代码库陷入混乱。尽管在专业术语上可能存在差异，这些规则对于像 Backbone 和 Ember 这样的诸多客户端 MVC 框架应该都适用。

某些框架具有不同的 MVC 命名约定，并且在关注点分离上采取了略有不同的策略。在本文中，*控制器*连接模型和视图之间的胶水，*视图*是 HTML 模板，*模型*仅仅处理数据存取和修饰。这个定义可以很好地适应 Backbone 和 Spine 框架的术语。 Ember也有类似的约定，但在将 DOM 访问从控制器逻辑中分离出来这一点上更进一步。

#### 控制器

- 控制器是介于视图和模型之间的胶水，其中的主要逻辑关注于事件管理。请保持控制器逻辑比较紧凑。
- 任何父控制器和子控制器之间的通信都应该使用事件（不要顺便传递一个父控制器的实例）。
- 应该只知道子控制器。
- 应该将作用域限定为单个元素，而不要访问或是改变 DOM 中的其他部分。
- 应该有一个独特的 class 名，并且所有该控制器相关的 CSS 都应该放置到这个 class 名的命名空间下。
- 应该在即使元素没有追加到 DOM 树的情况下也能正常工作。这对于测试和证实控制器确实正确地限定在作用域之内了很有用。
- 应该可以通过在它们的子元素上以程序触发事件来测试。
- 应该可以在任何时候无副作用地再次执行渲染。
- 不应使用 DOM 来存储状态——把任何视图特定的状态存到控制器的实例属性中。

#### 视图

- 除了流程控制和辅助函数，应该只包含很少的逻辑。
- 应该可以直接通过传入所有需要的数据完成渲染，在当前的作用域下应该全部可用。

#### 模型

- 应该只关心数据及其操作和修饰。
- 永远不应访问控制器或视图。
- 永远不应访问或返回 DOM 节点。
- 应该只能在运行时访问或请求其他模型。
- 应该将 XHR 连接从应用的其他部分中抽离出来。
- 应该包含所有的数据校验。

#### 路由

- 应该尽可能的不包含逻辑。
- 不应该知道或访问 DOM 。

#### 全局状态

- 应该保持为最小化的状态，因为可以说它的存在违背了 MVC 的思想。尽管某些东西你无法摆脱，像是当前用户、当前视图、 CSRF 令牌等。
- 永远不应存储在全局变量中。
- 应该全部存放到统一的位置（比如某个模型的单例实例）

#### 模块

- 应该始终采用一种模块系统，不论是 CommonJS 、 AMD 、ES6 模块或是其他类似的选择。
- 永远不要设置或访问全局变量。

---

#### 可接受Pull request

一篇风格指南应该是一份与时俱进的文档，会随着你的团队遇到特定的问题获得经验而不断演进。它的主要目的是保持代码库的一致性和整洁。如果你对这份文档有任何的建议，通过 [@maccaw](https://twitter.com/maccaw) 给我发tweet消息吧。